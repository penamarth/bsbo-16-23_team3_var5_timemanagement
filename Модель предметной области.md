# Модель предметной области

![Модель предметной области](.images/class-diagram.png)

```plantuml
@startuml
package Interfaces {
    interface IRole {
        +GetActions() : List<IAction>
    }
    interface IAction {
        +Execute()
    }
    interface IUserStorage {
        +GetById(userId:int) : User
        +Add(user:User)
    }
    interface ITaskStorage {
        +GetById(taskId:int) : Task
        +Upsert(task:Task) : Task
    }
}

package Roles {
    class Manager {
        +GetActions() : List<IAction>
    }
    class Employee {
        +GetActions() : List<IAction>
    }
    class SystemAdministrator {
        +GetActions() : List<IAction>
    }
    class User {
        +Id : int
        +Name : string
        +Role : IRole
        +PerformAction(action:IAction)
    }

    Manager ..|> IRole
    Employee ..|> IRole
    SystemAdministrator ..|> IRole
}

package Actions {
    class CreateTaskAction
    class TrackTaskExecutionAction
    class CollectStatisticsAction
    class MonitorWorkloadAction
    class TrackTaskStatusAction
    class CompleteTaskAction
    class TechSupportAction

    CreateTaskAction ..|> IAction
    TrackTaskExecutionAction ..|> IAction
    CollectStatisticsAction ..|> IAction
    MonitorWorkloadAction ..|> IAction
    TrackTaskStatusAction ..|> IAction
    CompleteTaskAction ..|> IAction
    TechSupportAction ..|> IAction
}

package Domain {
    class Task {
        -currentState : ITaskState
        -storage : ITaskStorage
        +assignTo(user:User)
        +advanceState(actor:User)
        +trackStatus() : string
        +getTaskDetails() : string
    }
}

package States {
    interface ITaskState {
        +FinishCurrentState(task:Task, actor:User)
    }
    class NewTaskState
    class InProgressTaskState
    class ClosedTaskState

    ITaskState <|.. NewTaskState
    ITaskState <|.. InProgressTaskState
    ITaskState <|.. ClosedTaskState
}

package Controllers {
    class TaskManagement {
        -userStorage : IUserStorage
        -tasks : List<Task>
        +CreateTask(managerId:int, title:string, description:string) : Task
        +AssignTask(managerId:int, taskId:int, assigneeId:int) : void
        +StartTask(employeeId:int, taskId:int) : void
        +CompleteTask(employeeId:int, taskId:int, hours:double) : void
        +TrackTaskStatus(userId:int, taskId:int) : string
        +ProvideTechSupport(adminId:int) : void
    }
}

TaskManagement ..|> ITaskStorage
TaskManagement --> IUserStorage
TaskManagement --> Task
Task --> User
Task --> ITaskState
Task --> ITaskStorage
User --> IRole

Manager --> CreateTaskAction
Manager --> TrackTaskExecutionAction
Manager --> CollectStatisticsAction
Manager --> MonitorWorkloadAction

Employee --> TrackTaskStatusAction
Employee --> CompleteTaskAction

SystemAdministrator --> TechSupportAction
@enduml
```
